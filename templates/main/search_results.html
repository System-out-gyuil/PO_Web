<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% load static %}
    <link rel="stylesheet" href="{% static 'main/search_results.css' %}" />
    <link rel="stylesheet" href="{% static 'base/base.css' %}" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6882409851484122"
     crossorigin="anonymous"></script>
    <title>검색 결과</title>
  </head>

  <body>
    <a href="{% url 'main' %}">
      <div class="main-subtitle">
        <div class="main-subtitle-text">
          <span class="orange-color">나</span>에게 <span class="orange-color">맞</span>는 <span class="orange-color">지</span>원금
        </div>
      </div>
    </a>
    <div class="main-container">
      <span class="orange-color">{{ region }}</span>에서 <span class="orange-color">{{ industry }}</span>을 운영하시는<br />
      대표님을 위한 지원 사업은..!
    </div>

    {% if results %} 
    {% for p in results %}
    <div style="margin-bottom: 20px" class="search-result-container">
      <div class="count-number"><span class="orange-color">{{ results.start_index|add:forloop.counter0 }}</span>번째 공고</div><br />
      
      <div class="match-score">
        매칭 점수:
        {% for i in "12345" %}
          {% if forloop.counter <= p.매칭점수 %}
            ⭐
          {% else %}
            ☆
          {% endif %}
        {% endfor %}
      </div>
      
      <strong>📢 {{ p.공고명 }}</strong><br />

      📍 <strong>지역:</strong> {{ p.지역 }}<br />

      🏭 <strong>업종:</strong> {{ p.가능업종 }}<br />

      🚢 <strong>수출 실적 여부:</strong> {{ p.수출실적여부 }}<br />

      💰 <strong>지원 규모:</strong> 
      {% if p.지원규모.items %}
      <ul style="margin: 5px 0">
        {% for key, value in p.지원규모.items %}
        <li>{{ key }}: {{ value }}</li>
        {% endfor %}
      </ul>
      {% else %} {{ p.지원규모 }} {% endif %} <br />

      💰 <strong>매출 규모:</strong>{{ p.매출규모 }}<br />

      👤 <strong>지원 자격:</strong>
      {% if p.지원자격.items %}
      <ul style="margin: 5px 0">
        {% for key, value in p.지원자격.items %}
        <li>{{ key }}: {{ value }}</li>
        {% endfor %}
      </ul>
      {% else %} {{ p.지원자격 }} {% endif %} <br />

      📆 <strong>사업 기간(업력):</strong>{{ p.사업기간 }}<br />

      📆 <strong>모집 기간:</strong>
      {% if p.모집종료일 == "9999-12-31" %}사업비 소진 시 까지 (상시접수) 
      {% elif p.모집시작일 == "0000-01-01" %} ~ {{ p.모집종료일 }} 
      {% else %}{{ p.모집시작일 }} ~ {{ p.모집종료일 }} 
      {% endif %}
      <br />

      <strong>핵심 키워드:</strong> {{ p.핵심키워드 }}<br />

      <!-- 공고 내용 -->
      <p id="summary-{{ forloop.counter }}" class="summary"><strong>📄공고내용 요약 :</strong> {{ p.공고내용}}</p>
      <p id="full-{{ forloop.counter }}" class="full-text"><strong>📄공고내용 요약 :</strong> {{ p.공고내용}}</p>

      <button id="button-{{ forloop.counter }}" class="more-button" onclick="toggleContent('{{ forloop.counter }}')">더보기</button>
    </div>
    <hr />
    {% endfor %}
    <!-- 페이지네이션 -->
    <div class="pagination">
      {% if results.has_previous %}
      <a href="?page={{ results.previous_page_number }}&region={{ region }}&industry={{ industry }}">이전</a>
      {% endif %}
      <span>{{ results.number }} / {{ results.paginator.num_pages }}</span>
      {% if results.has_next %}
      <a href="?page={{ results.next_page_number }}&region={{ region }}&industry={{ industry }}">다음</a>
      {% endif %}
    </div>

    {% else %}
    <p>❗ 조건에 맞는 결과가 없습니다.</p>
    {% endif %}
    <div class="button-container">
      <div class="button-container-item">
        <a href="{% url 'main' %}" class="orange-color">첫 화면으로</a>
      </div>
      <div class="button-container-item">
        <a href="{% url 'counsel_form' %}" class="orange-color">전문가 상담</a>
      </div>
    </div>
    {% include 'base/coupang_banner.html' %}
    <script src="{% static 'main/main.js' %}"></script>
  </body>
</html>
